require(["Config","Notifications","dojo/query","dojo/dom-form","dojo/dom-construct","dojo/ready"],function(e,t,n,r,i,s){function f(){esri.request({url:e.billing+"/p/sellableCountry",content:{f:"json"},handleAs:"json"}).then(function(e){e.code==200?e.sellable===!0?(n("#loading-message").addClass("hide"),n("#trial-wrapper").removeClass("hide")):(n("#loading-message").addClass("hide"),n("#unavailable-message").removeClass("hide")):(n("#loading-message").addClass("hide"),n("#error-message").removeClass("hide"))},function(e){n("#loading-message").addClass("hide"),n("#error-message").removeClass("hide")})}function l(){n("#submitBtn").attr("disabled",!1).attr("value","Sign up for ArcGIS for Developers")}function c(e){var t=!0;return n(".error-message").remove(),n(".error").removeClass("error"),e.firstName||(t=!1,n("input[name='firstName']").addClass("error")),e.lastName||(t=!1,n("input[name='lastName']").addClass("error")),e.email?e.email.match(o)&&(t=!1,a.clear(),a.error(u)):(t=!1,n("input[name='email']").addClass("error")),t}function h(t){n("#submitBtn").attr("disabled",!0).attr("value","Submitting..."),t.f="json",esri.request({url:e.billing+"/subscription/create",content:t,handleAs:"json"},{usePost:!0}).then(function(e){e&&e.hasOwnProperty("status")&&e.status.toLowerCase()=="success"?window.location="/"+dojo.locale.substr(0,2)+"/post-signup?email="+t.email:p()},function(e){p()})}function p(){i.create("div",{"class":"error-message",innerHTML:"We were unable to complete your request at this time."},"trial-form","before"),n("#submitBtn").attr("disabled",!1).attr("value","Sign up for ArcGIS for Developers")}var o=/.gov$/i,u="Due to <a class='error-anchor' target='_blank' href='http://csrc.nist.gov/groups/SMA/fisma/index.html'>FISMA</a> compliance standards, the ArcGIS for Developers sign-up <br /> does not currently support federal entities. <br />Please visit <a class='error-anchor' href='http://arcgis.com'>http://arcgis.com</a> to set up an account.",a="";s(function(){a=new t(n("#emailNotifications")),l(),f()}),n("input[name='email']").on("change",function(e){var t=n(e.target).val();t.match(o)?(a.clear(),a.error(u)):a.clear()}),n("#trial-form").on("submit",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=r.toObject("trial-form");if(!c(t))return;h(t)})});