require(["Config","SessionManager","Notifications","dojo/query"],function(e,t,n,r){function i(){r("#credits-remaining").html(t.organization.subscriptionInfo.availableCredits)}function s(){r("#submitBtn").attr("disabled",!0),r("#notifications").empty(),esri.request({url:"https://billingdev.arcgis.com/smsbilling/cancel-subscription",content:{token:t.token(),f:"json"}}).then(function(e){e.code!="200"&&(o(),r("#submitBtn").attr("disabled",!1))},function(e){r("#agreement-wrapper").addClass("hide"),r("#preCommitMessage").addClass("hide"),r("#postCommitMessage").removeClass("hide")})}function o(e){e=e||"We were unable to complete your request at this time.",r("#notifications").empty();var t=new n(r("#notifications"));t.error(e)}t.queue(i),r("input[name='agreement']").on("change",function(e){r("#submitBtn").attr("disabled",!e.target.checked)}),r("#submitBtn").on("click",function(e){s()})});